{"version":3,"file":"index.js","mappings":";;;;;;;;;AAAA,QAAQ,OAAO,EAAE,mBAAO,CAAC,oCAAe;AACxC,QAAQ,YAAY,EAAE,mBAAO,CAAC,kBAAM;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,SAAS;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,SAAS;AACrB;AACA,wBAAwB,8CAAoB,CAAC,6CAAqB;AAClE,iBAAiB,mBAAO,CAAC,cAAI;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B,qMAAoB,QAAQ,eAAe;AACxE;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA,UAAU,qDAAqD;AAC/D;AACA,UAAU,gBAAgB,EAAE,mBAAO,CAAC,0BAAU;AAC9C;AACA;AACA;AACA;AACA,+BAA+B,iBAAiB,sBAAsB,UAAU;AAChF;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,6BAA6B,qMAAoB,QAAQ,eAAe;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,oBAAoB;AACxD;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,qMAAoB,QAAQ,eAAe;AAC1E;AACA;AACA;AACA;AACA,kCAAkC,MAAM;AACxC;AACA;AACA,OAAO;AACP;AACA,iCAAiC,SAAS;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,IAAI;AACJ,aAAa;AACb;AACA;AACA;AACA,mBAAmB;;;;;;;;;;;;ACtJnB,mC;;;;;;;;;;;ACAA,0C;;;;;;;;;;;ACAA,qC;;;;;;;;;;;ACAA,+B;;;;;;;;;;;ACAA,wC;;;;;;;;;;;ACAA,oC;;;;;;;;;;;ACAA,sC;;;;;;;;;;;ACAA,uC;;;;;;;;;;;ACAA,qC;;;;;;;;;;;ACAA,sC;;;;;;;;;;;ACAA,yC;;;;;;;;;;;ACAA,wC;;;;;;;;;;;ACAA,4C;;;;;;;;;;;ACAA,qC;;;;;;;;;;;ACAA,sC;;;;;;;;;;;ACAA,sC;;;;;;;;;;;ACAA,+B;;;;;;;;;;;ACAA,iC;;;;;;;;;;;ACAA,iC;;;;;;;;;;;ACAA,2C;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;UAEA;UACA;;;;;WC/BA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA,E;;;;;WCPA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,EAAE;WACF,E;;;;;WCRA;WACA;WACA;WACA;WACA,E;;;;;WCJA,wF;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D,E;;;;;WCNA;;WAEA;WACA;WACA;WACA;WACA;;WAEA;;WAEA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,gBAAgB,qBAAqB;WACrC;;WAEA;;WAEA;WACA;WACA;WACA;WACA,aAAa;WACb;WACA;WACA;WACA;WACA,IAAI;WACJ;WACA;;WAEA;;WAEA;;WAEA,kB;;;;;;;;;;ACxCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAE,EAAE,mBAAO,CAAC,0BAAU;AACtB,WAAW,8CAAsB;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,2FAAiC;AAC7C,GAAG;AACH,EAAE;AACF;AACA,oBAAoB,8CAAyB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL,MAAM,mBAAmB;AACzB;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA,MAAM,cAAc;AACpB,MAAM,cAAc;AACpB,MAAM,mBAAmB;AACzB,MAAM,aAAa;AACnB,MAAM,cAAc;AACpB,MAAM,eAAe;AACrB,MAAM,mBAAmB;AACzB;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,MAAM;AACN,KAAK;AACL,MAAM,mBAAmB;AACzB,MAAM,0BAA0B;AAChC;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,yDAAyD;AACvE,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD,yBAAyB;AACzE,IAAI;AACJ,wDAAwD,cAAc;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,sCAAsC;AACpD,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC;AAChC;AACA;AACA;AACA,WAAW;AACX,GAAG;AACH,WAAW;AACX;AACA,CAAC;AACD;AACA;AACA;AACA,CAAC;AACD;AACA,+CAA+C,mBAAmB;AAClE;AACA,UAAU,cAAc,EAAE,mBAAO,CAAC,iDAAkB;AACpD;AACA;AACA,GAAG;AACH,WAAW;AACX;AACA,CAAC;AACD;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA,CAAC","sources":["webpack://markpad/./src/gist-publisher.js","webpack://markpad/external node-commonjs \"buffer\"","webpack://markpad/external node-commonjs \"child_process\"","webpack://markpad/external node-commonjs \"electron\"","webpack://markpad/external node-commonjs \"fs\"","webpack://markpad/external node-commonjs \"node:buffer\"","webpack://markpad/external node-commonjs \"node:fs\"","webpack://markpad/external node-commonjs \"node:http\"","webpack://markpad/external node-commonjs \"node:https\"","webpack://markpad/external node-commonjs \"node:net\"","webpack://markpad/external node-commonjs \"node:path\"","webpack://markpad/external node-commonjs \"node:process\"","webpack://markpad/external node-commonjs \"node:stream\"","webpack://markpad/external node-commonjs \"node:stream/web\"","webpack://markpad/external node-commonjs \"node:url\"","webpack://markpad/external node-commonjs \"node:util\"","webpack://markpad/external node-commonjs \"node:zlib\"","webpack://markpad/external node-commonjs \"os\"","webpack://markpad/external node-commonjs \"path\"","webpack://markpad/external node-commonjs \"util\"","webpack://markpad/external node-commonjs \"worker_threads\"","webpack://markpad/webpack/bootstrap","webpack://markpad/webpack/runtime/define property getters","webpack://markpad/webpack/runtime/ensure chunk","webpack://markpad/webpack/runtime/get javascript chunk filename","webpack://markpad/webpack/runtime/hasOwnProperty shorthand","webpack://markpad/webpack/runtime/make namespace object","webpack://markpad/webpack/runtime/require chunk loading","webpack://markpad/./src/main.js"],"sourcesContent":["const { exec } = require('child_process');\r\nconst { promisify } = require('util');\r\nconst execAsync = promisify(exec);\r\n\r\nconst GITHUB_OAUTH_CLIENT_ID = 'Ov23liLXwH4cYIjKCy8e';\r\n\r\nasync function getAuthToken() {\r\n  try {\r\n    const token = await tryGitHubCLI();\r\n    if (token) return token;\r\n  } catch (err) {\r\n    console.log('GitHub CLI not available:', err.message);\r\n  }\r\n\r\n  try {\r\n    const token = await tryCopilotCLI();\r\n    if (token) return token;\r\n  } catch (err) {\r\n    console.log('Copilot CLI not available:', err.message);\r\n  }\r\n\r\n  return await deviceFlowAuth();\r\n}\r\n\r\nasync function tryGitHubCLI() {\r\n  const { stdout } = await execAsync('gh auth token');\r\n  const token = stdout.trim();\r\n  if (token && token.startsWith('gh')) {\r\n    return token;\r\n  }\r\n  throw new Error('No valid token from gh CLI');\r\n}\r\n\r\nasync function tryCopilotCLI() {\r\n  try {\r\n    const { stdout } = await execAsync('github-copilot-cli --version');\r\n    if (stdout) {\r\n      const tokenPath = require('path').join(require('os').homedir(), '.config', 'github-copilot', 'hosts.json');\r\n      const fs = require('fs');\r\n      if (fs.existsSync(tokenPath)) {\r\n        const hostsData = JSON.parse(fs.readFileSync(tokenPath, 'utf8'));\r\n        const token = hostsData?.['github.com']?.oauth_token;\r\n        if (token) return token;\r\n      }\r\n    }\r\n  } catch (err) {\r\n    throw new Error('Copilot CLI not available or not authenticated');\r\n  }\r\n  throw new Error('No token from Copilot CLI');\r\n}\r\n\r\nasync function deviceFlowAuth() {\r\n  const fetch = (...args) => import('node-fetch').then(({default: fetch}) => fetch(...args));\r\n  \r\n  const deviceCodeResponse = await (await fetch('https://github.com/login/device/code', {\r\n    method: 'POST',\r\n    headers: {\r\n      'Accept': 'application/json',\r\n      'Content-Type': 'application/json'\r\n    },\r\n    body: JSON.stringify({\r\n      client_id: GITHUB_OAUTH_CLIENT_ID,\r\n      scope: 'gist'\r\n    })\r\n  })).json();\r\n\r\n  const { device_code, user_code, verification_uri, interval } = deviceCodeResponse;\r\n\r\n  const { shell, dialog } = require('electron');\r\n  \r\n  await dialog.showMessageBox({\r\n    type: 'info',\r\n    title: 'GitHub Authentication',\r\n    message: `Please visit:\\n${verification_uri}\\n\\nAnd enter code: ${user_code}`,\r\n    buttons: ['Open Browser', 'OK']\r\n  }).then((result) => {\r\n    if (result.response === 0) {\r\n      shell.openExternal(verification_uri);\r\n    }\r\n  });\r\n\r\n  return await pollForToken(device_code, interval || 5);\r\n}\r\n\r\nasync function pollForToken(deviceCode, interval) {\r\n  const fetch = (...args) => import('node-fetch').then(({default: fetch}) => fetch(...args));\r\n  \r\n  while (true) {\r\n    await new Promise(resolve => setTimeout(resolve, interval * 1000));\r\n    \r\n    const tokenResponse = await (await fetch('https://github.com/login/oauth/access_token', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Accept': 'application/json',\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        client_id: GITHUB_OAUTH_CLIENT_ID,\r\n        device_code: deviceCode,\r\n        grant_type: 'urn:ietf:params:oauth:grant-type:device_code'\r\n      })\r\n    })).json();\r\n\r\n    if (tokenResponse.access_token) {\r\n      return tokenResponse.access_token;\r\n    }\r\n    \r\n    if (tokenResponse.error === 'authorization_pending') {\r\n      continue;\r\n    }\r\n    \r\n    throw new Error(`Auth failed: ${tokenResponse.error}`);\r\n  }\r\n}\r\n\r\nasync function publishGist(filename, content) {\r\n  try {\r\n    const token = await getAuthToken();\r\n    const fetch = (...args) => import('node-fetch').then(({default: fetch}) => fetch(...args));\r\n    \r\n    const response = await (await fetch('https://api.github.com/gists', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Authorization': `token ${token}`,\r\n        'Accept': 'application/vnd.github.v3+json',\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: JSON.stringify({\r\n        description: `Markpad: ${filename}`,\r\n        public: false,\r\n        files: {\r\n          [filename]: {\r\n            content: content\r\n          }\r\n        }\r\n      })\r\n    }));\r\n\r\n    if (!response.ok) {\r\n      const error = await response.json();\r\n      throw new Error(error.message || 'Failed to create gist');\r\n    }\r\n\r\n    const gist = await response.json();\r\n    return { success: true, url: gist.html_url };\r\n  } catch (error) {\r\n    return { success: false, error: error.message };\r\n  }\r\n}\r\n\r\nmodule.exports = { publishGist };\r\n","module.exports = require(\"buffer\");","module.exports = require(\"child_process\");","module.exports = require(\"electron\");","module.exports = require(\"fs\");","module.exports = require(\"node:buffer\");","module.exports = require(\"node:fs\");","module.exports = require(\"node:http\");","module.exports = require(\"node:https\");","module.exports = require(\"node:net\");","module.exports = require(\"node:path\");","module.exports = require(\"node:process\");","module.exports = require(\"node:stream\");","module.exports = require(\"node:stream/web\");","module.exports = require(\"node:url\");","module.exports = require(\"node:util\");","module.exports = require(\"node:zlib\");","module.exports = require(\"os\");","module.exports = require(\"path\");","module.exports = require(\"util\");","module.exports = require(\"worker_threads\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Check if module exists (development only)\n\tif (__webpack_modules__[moduleId] === undefined) {\n\t\tvar e = new Error(\"Cannot find module '\" + moduleId + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".index.js\";\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded chunks\n// \"1\" means \"loaded\", otherwise not loaded yet\nvar installedChunks = {\n\t\"main\": 1\n};\n\n// no on chunks loaded\n\nvar installChunk = (chunk) => {\n\tvar moreModules = chunk.modules, chunkIds = chunk.ids, runtime = chunk.runtime;\n\tfor(var moduleId in moreModules) {\n\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t}\n\t}\n\tif(runtime) runtime(__webpack_require__);\n\tfor(var i = 0; i < chunkIds.length; i++)\n\t\tinstalledChunks[chunkIds[i]] = 1;\n\n};\n\n// require() chunk loading for javascript\n__webpack_require__.f.require = (chunkId, promises) => {\n\t// \"1\" is the signal for \"already loaded\"\n\tif(!installedChunks[chunkId]) {\n\t\tif(true) { // all chunks have JS\n\t\t\tvar installedChunk = require(\"./\" + __webpack_require__.u(chunkId));\n\t\t\tif (!installedChunks[chunkId]) {\n\t\t\t\tinstallChunk(installedChunk);\n\t\t\t}\n\t\t} else installedChunks[chunkId] = 1;\n\t}\n};\n\n// no external install chunk\n\n// no HMR\n\n// no HMR manifest","const {\r\n\tapp,\r\n\tBrowserWindow,\r\n\tMenu,\r\n\tdialog,\r\n\tipcMain,\r\n\tshell,\r\n} = require(\"electron\");\r\nconst fs = require(\"fs\").promises;\r\n\r\nlet mainWindow;\r\nlet currentFilePath = null;\r\n\r\nfunction createWindow() {\r\n\tmainWindow = new BrowserWindow({\r\n\t\twidth: 1200,\r\n\t\theight: 800,\r\n\t\twebPreferences: {\r\n\t\t\tnodeIntegration: false,\r\n\t\t\tcontextIsolation: true,\r\n\t\t\tpreload: MAIN_WINDOW_PRELOAD_WEBPACK_ENTRY,\r\n\t\t},\r\n\t});\r\n\r\n\tmainWindow.loadURL(MAIN_WINDOW_WEBPACK_ENTRY);\r\n\r\n\tconst template = [\r\n\t\t{\r\n\t\t\tlabel: \"File\",\r\n\t\t\tsubmenu: [\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"New\",\r\n\t\t\t\t\taccelerator: \"CmdOrCtrl+N\",\r\n\t\t\t\t\tclick: () => mainWindow.webContents.send(\"file-new\"),\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Open\",\r\n\t\t\t\t\taccelerator: \"CmdOrCtrl+O\",\r\n\t\t\t\t\tclick: () => openFile(),\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Save\",\r\n\t\t\t\t\taccelerator: \"CmdOrCtrl+S\",\r\n\t\t\t\t\tclick: () => saveFile(),\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Save As\",\r\n\t\t\t\t\taccelerator: \"CmdOrCtrl+Shift+S\",\r\n\t\t\t\t\tclick: () => saveFileAs(),\r\n\t\t\t\t},\r\n\t\t\t\t{ type: \"separator\" },\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Quit\",\r\n\t\t\t\t\taccelerator: \"CmdOrCtrl+Q\",\r\n\t\t\t\t\tclick: () => app.quit(),\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Edit\",\r\n\t\t\tsubmenu: [\r\n\t\t\t\t{ role: \"undo\" },\r\n\t\t\t\t{ role: \"redo\" },\r\n\t\t\t\t{ type: \"separator\" },\r\n\t\t\t\t{ role: \"cut\" },\r\n\t\t\t\t{ role: \"copy\" },\r\n\t\t\t\t{ role: \"paste\" },\r\n\t\t\t\t{ role: \"selectAll\" },\r\n\t\t\t],\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"View\",\r\n\t\t\tsubmenu: [\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Zoom In\",\r\n\t\t\t\t\taccelerator: \"CmdOrCtrl+=\",\r\n\t\t\t\t\tclick: () => {\r\n\t\t\t\t\t\tconst currentZoom = mainWindow.webContents.getZoomLevel();\r\n\t\t\t\t\t\tmainWindow.webContents.setZoomLevel(currentZoom + 0.5);\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Zoom Out\",\r\n\t\t\t\t\taccelerator: \"CmdOrCtrl+-\",\r\n\t\t\t\t\tclick: () => {\r\n\t\t\t\t\t\tconst currentZoom = mainWindow.webContents.getZoomLevel();\r\n\t\t\t\t\t\tmainWindow.webContents.setZoomLevel(currentZoom - 0.5);\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Reset Zoom\",\r\n\t\t\t\t\taccelerator: \"CmdOrCtrl+0\",\r\n\t\t\t\t\tclick: () => {\r\n\t\t\t\t\t\tmainWindow.webContents.setZoomLevel(0);\r\n\t\t\t\t\t},\r\n\t\t\t\t},\r\n\t\t\t\t{ type: \"separator\" },\r\n\t\t\t\t{ role: \"togglefullscreen\" },\r\n\t\t\t],\r\n\t\t},\r\n\t\t{\r\n\t\t\tlabel: \"Gist\",\r\n\t\t\tsubmenu: [\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Publish to Gist\",\r\n\t\t\t\t\taccelerator: \"CmdOrCtrl+G\",\r\n\t\t\t\t\tclick: () => mainWindow.webContents.send(\"publish-gist\"),\r\n\t\t\t\t},\r\n\t\t\t],\r\n\t\t},\r\n\t];\r\n\r\n\tconst menu = Menu.buildFromTemplate(template);\r\n\tMenu.setApplicationMenu(menu);\r\n}\r\n\r\nasync function openFile() {\r\n\tconst result = await dialog.showOpenDialog(mainWindow, {\r\n\t\tproperties: [\"openFile\"],\r\n\t\tfilters: [{ name: \"Markdown\", extensions: [\"md\", \"markdown\", \"txt\"] }],\r\n\t});\r\n\r\n\tif (!result.canceled && result.filePaths.length > 0) {\r\n\t\tconst filePath = result.filePaths[0];\r\n\t\ttry {\r\n\t\t\tconst content = await fs.readFile(filePath, \"utf8\");\r\n\t\t\tcurrentFilePath = filePath;\r\n\t\t\tmainWindow.webContents.send(\"file-opened\", { path: filePath, content });\r\n\t\t} catch (error) {\r\n\t\t\tdialog.showErrorBox(\"Error\", `Failed to open file: ${error.message}`);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nasync function saveFile() {\r\n\tif (currentFilePath) {\r\n\t\tmainWindow.webContents.send(\"request-content-for-save\");\r\n\t} else {\r\n\t\tawait saveFileAs();\r\n\t}\r\n}\r\n\r\nasync function saveFileAs() {\r\n\tconst result = await dialog.showSaveDialog(mainWindow, {\r\n\t\tfilters: [{ name: \"Markdown\", extensions: [\"md\"] }],\r\n\t});\r\n\r\n\tif (!result.canceled && result.filePath) {\r\n\t\tcurrentFilePath = result.filePath;\r\n\t\tmainWindow.webContents.send(\"request-content-for-save\");\r\n\t}\r\n}\r\n\r\nipcMain.handle(\"save-content\", async (event, content) => {\r\n\tif (!currentFilePath) return { success: false, error: \"No file path\" };\r\n\r\n\ttry {\r\n\t\tawait fs.writeFile(currentFilePath, content, \"utf8\");\r\n\t\treturn { success: true, path: currentFilePath };\r\n\t} catch (error) {\r\n\t\treturn { success: false, error: error.message };\r\n\t}\r\n});\r\n\r\nipcMain.handle(\"get-current-file-path\", () => {\r\n\treturn currentFilePath;\r\n});\r\n\r\nipcMain.handle(\"publish-gist\", async (event, { filename, content }) => {\r\n\ttry {\r\n\t\tconst { publishGist } = require(\"./gist-publisher\");\r\n\t\tconst result = await publishGist(filename, content);\r\n\t\treturn result;\r\n\t} catch (error) {\r\n\t\treturn { success: false, error: error.message };\r\n\t}\r\n});\r\n\r\nipcMain.handle(\"open-external\", async (event, url) => {\r\n\tawait shell.openExternal(url);\r\n});\r\n\r\napp.whenReady().then(createWindow);\r\n\r\napp.on(\"window-all-closed\", () => {\r\n\tif (process.platform !== \"darwin\") {\r\n\t\tapp.quit();\r\n\t}\r\n});\r\n\r\napp.on(\"activate\", () => {\r\n\tif (BrowserWindow.getAllWindows().length === 0) {\r\n\t\tcreateWindow();\r\n\t}\r\n});\r\n"],"names":[],"ignoreList":[],"sourceRoot":""}